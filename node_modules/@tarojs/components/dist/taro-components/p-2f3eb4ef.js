import{r as t,c as i,h as o,H as e}from"./p-f72fcd8c.js";import{c as s}from"./p-160d710a.js";const a="http://ossin.jd.com/swm-plus/h5Tag/tag.js",r=t=>{if(!t.startsWith("lego://"))return null;try{const i=t.substring(7),[o,e]=i.split("?");return{tagId:o,text:e&&new URLSearchParams(e).get("text")||""}}catch(i){return console.warn("Failed to parse lego URL:",t,i),null}},h=class{constructor(o){t(this,o),this.onLoad=i(this,"load",7),this.onError=i(this,"error",7),this.src=void 0,this.mode="scaleToFill",this.lazyLoad=!1,this.nativeProps={},this.lang=void 0,this.aspectFillMode="width",this.didLoad=!1}componentDidLoad(){if(null!==r(this.src)&&(()=>{if(null!==document.querySelector(`script[src="${a}"]`))return;const t=document.createElement("script");t.type="module",t.src=a,document.head.appendChild(t)})(),!this.lazyLoad)return;const t=new IntersectionObserver((i=>{i[i.length-1].isIntersecting&&(t.unobserve(this.imgRef),this.didLoad=!0)}),{rootMargin:"300px 0px"});t.observe(this.imgRef)}imageOnLoad(){const{width:t,height:i,naturalWidth:o,naturalHeight:e}=this.imgRef;this.onLoad.emit({width:t,height:i}),this.aspectFillMode=o>e?"width":"height"}imageOnError(t){this.onError.emit(t)}render(){const{src:t,lazyLoad:i=!1,aspectFillMode:a="width",imageOnLoad:h,imageOnError:n,nativeProps:l,didLoad:m,lang:d}=this,g=this.mode||"scaleToFill",c=r(t),p=null!==c,_=s({"taro-img__widthfix":"widthFix"===g}),f=s(`taro-img__mode-${g.toLowerCase().replace(/\s/g,"")}`,{[`taro-img__mode-aspectfill--${a}`]:"aspectFill"===g});return o(e,{class:_},p&&c?o("canvas-tag",Object.assign({tagId:c.tagId,text:c.text,lang:d},l)):t?o("img",Object.assign({ref:t=>this.imgRef=t,class:f,src:i&&!m?void 0:t,onLoad:h.bind(this),onError:n.bind(this)},l)):"")}};h.style='img[src=""]{opacity:0}taro-image-core{width:320px;height:240px;font-size:0;display:inline-block;position:relative;overflow:hidden}.taro-img.taro-img__widthfix{height:100%}.taro-img__mode-scaletofill{width:100%;height:100%}.taro-img__mode-aspectfit{max-width:100%;max-height:100%;position:absolute;top:50%;transform:translateY(-50%)}.taro-img__mode-aspectfill{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.taro-img__mode-aspectfill--width{min-width:100%;height:100%}.taro-img__mode-aspectfill--height{width:100%;min-height:100%}.taro-img__mode-widthfix{width:100%}.taro-img__mode-heightfix{height:100%}.taro-img__mode-top{position:absolute;left:50%;transform:translate(-50%)}.taro-img__mode-bottom{position:absolute;bottom:0;left:50%;transform:translate(-50%)}.taro-img__mode-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.taro-img__mode-left{position:absolute;top:50%;transform:translateY(-50%)}.taro-img__mode-right{position:absolute;top:50%;right:0;transform:translateY(-50%)}.taro-img__mode-topright{position:absolute;right:0}.taro-img__mode-bottomleft{position:absolute;bottom:0}.taro-img__mode-bottomright{position:absolute;bottom:0;right:0}';export{h as I}