{"version":3,"file":"index.js","sources":["../../src/interceptor/index.ts"],"sourcesContent":["import Chain from './chain'\n\nimport type { IRequestParams, TInterceptor } from './chain'\n\nexport default class Link {\n  taroInterceptor: TInterceptor\n  chain: Chain\n\n  constructor (interceptor: TInterceptor) {\n    this.taroInterceptor = interceptor\n    this.chain = new Chain()\n  }\n\n  request (requestParams: IRequestParams) {\n    const chain = this.chain\n    const taroInterceptor = this.taroInterceptor\n\n    chain.interceptors = chain.interceptors\n      .filter(interceptor => interceptor !== taroInterceptor)\n      .concat(taroInterceptor)\n\n    return chain.proceed({ ...requestParams })\n  }\n\n  addInterceptor (interceptor: TInterceptor) {\n    this.chain.interceptors.push(interceptor)\n  }\n\n  cleanInterceptors () {\n    this.chain = new Chain()\n  }\n}\n\nexport function interceptorify (promisifyApi) {\n  return new Link(function (chain) {\n    return promisifyApi(chain.requestParams)\n  })\n}\n"],"names":[],"mappings":";;AAIc,MAAO,IAAI,CAAA;AAIvB,IAAA,WAAA,CAAa,WAAyB,EAAA;AACpC,QAAA,IAAI,CAAC,eAAe,GAAG,WAAW;AAClC,QAAA,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE;;AAG1B,IAAA,OAAO,CAAE,aAA6B,EAAA;AACpC,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK;AACxB,QAAA,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe;AAE5C,QAAA,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC;aACxB,MAAM,CAAC,WAAW,IAAI,WAAW,KAAK,eAAe;aACrD,MAAM,CAAC,eAAe,CAAC;AAE1B,QAAA,OAAO,KAAK,CAAC,OAAO,CAAM,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,aAAa,EAAG;;AAG5C,IAAA,cAAc,CAAE,WAAyB,EAAA;QACvC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC;;IAG3C,iBAAiB,GAAA;AACf,QAAA,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE;;AAE3B;AAEK,SAAU,cAAc,CAAE,YAAY,EAAA;AAC1C,IAAA,OAAO,IAAI,IAAI,CAAC,UAAU,KAAK,EAAA;AAC7B,QAAA,OAAO,YAAY,CAAC,KAAK,CAAC,aAAa,CAAC;AAC1C,KAAC,CAAC;AACJ;;;;"}